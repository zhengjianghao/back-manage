{"ast":null,"code":"import \"antd/lib/message/style/css\";\nimport _message from \"antd/lib/message\";\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\nimport axios from 'axios';\nconst $axios = axios.create({\n  baseURL: process.env.REACT_APP_BASE_URL,\n  timeout: 6000,\n  retry: 4,\n  retryDelay: 1000\n});\n\n//请求拦截\n$axios.interceptors.request.use(function (config) {\n  // 在发送请求之前做些什么\n  // 通过reudx的store拿到拿到全局状态树的token ，添加到请求报文，后台会根据该报文返回status\n  // 此处应根据具体业务写token\n  // const token = store.getState().user.token || localStorage.getItem('token');\n  const token = 'FA2019';\n  config.headers['X-Token'] = token;\n  return config;\n}, function (error) {\n  // 对请求错误做些什么\n  _message.error(error);\n  return Promise.reject(error);\n});\n\n// 添加响应拦截器\n$axios.interceptors.response.use(function (response) {\n  // 对响应数据做点什么\n  if (response.data.success === false) {\n    _message.error(response.data.message);\n  }\n  return response;\n}, function (error) {\n  if (error.code === 'ECONNABORTED' && error.message.indexOf('timeout') !== -1) {\n    var config = error.config;\n    config.__retryCount = config.__retryCount || 0;\n    if (config.__retryCount >= config.retry) {\n      // Reject with the error\n      //window.location.reload();\n      return Promise.reject(error);\n    }\n\n    // Increase the retry count\n    config.__retryCount += 1;\n\n    // Create new promise to handle exponential backoff\n    var backoff = new Promise(function (resolve) {\n      setTimeout(function () {\n        //console.log('resolve');\n        resolve();\n      }, config.retryDelay || 1);\n    });\n    return backoff.then(function () {\n      return axios(config);\n    });\n  } else {\n    return Promise.reject(error);\n  }\n});\nconst _default = $axios;\nexport default _default;\n;\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n  if (!reactHotLoader) {\n    return;\n  }\n  reactHotLoader.register($axios, \"$axios\", \"/Users/zhengjianghao/\\u9879\\u76EE/react-antd-admin-master/src/axios/$axios.js\");\n  reactHotLoader.register(_default, \"default\", \"/Users/zhengjianghao/\\u9879\\u76EE/react-antd-admin-master/src/axios/$axios.js\");\n})();\n;\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"names":["axios","$axios","create","baseURL","process","env","REACT_APP_BASE_URL","timeout","retry","retryDelay","interceptors","request","use","config","token","headers","error","_message","Promise","reject","response","data","success","message","code","indexOf","__retryCount","backoff","resolve","setTimeout","then","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/zhengjianghao/项目/react-antd-admin-master/src/axios/$axios.js"],"sourcesContent":["import axios from 'axios';\nimport { message } from 'antd';\nconst $axios = axios.create({\n\tbaseURL: process.env.REACT_APP_BASE_URL,\n\ttimeout: 6000,\n\tretry:4,\n\tretryDelay:1000\n});\n\n//请求拦截\n$axios.interceptors.request.use(\n\tfunction(config) {\n\t\t// 在发送请求之前做些什么\n\t\t// 通过reudx的store拿到拿到全局状态树的token ，添加到请求报文，后台会根据该报文返回status\n\t\t// 此处应根据具体业务写token\n\t\t// const token = store.getState().user.token || localStorage.getItem('token');\n\t\tconst token = 'FA2019';\n\t\tconfig.headers['X-Token'] = token;\n\t\treturn config;\n\t},\n\tfunction(error) {\n\t\t// 对请求错误做些什么\n\t\tmessage.error(error);\n\t\treturn Promise.reject(error);\n\t}\n);\n\n// 添加响应拦截器\n$axios.interceptors.response.use(\n\tfunction(response) {\n\t\t// 对响应数据做点什么\n\t\tif (response.data.success === false) {\n\t\t\tmessage.error(response.data.message);\n\t\t}\n\t\treturn response;\n\t},\n\tfunction(error) {\n\t\tif (error.code === 'ECONNABORTED' && error.message.indexOf('timeout') !== -1) {\n\t\t\tvar config = error.config;\n\t\t\tconfig.__retryCount = config.__retryCount || 0;\n\n\t\t\tif (config.__retryCount >= config.retry) {\n\t\t\t\t// Reject with the error\n\t\t\t\t//window.location.reload();\n\t\t\t\treturn Promise.reject(error);\n\t\t\t}\n\n\t\t\t// Increase the retry count\n\t\t\tconfig.__retryCount += 1;\n\n\t\t\t// Create new promise to handle exponential backoff\n\t\t\tvar backoff = new Promise(function(resolve) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t//console.log('resolve');\n\t\t\t\t\tresolve();\n\t\t\t\t}, config.retryDelay || 1);\n\t\t\t});\n\n\t\t\treturn backoff.then(function() {\n\t\t\t\treturn axios(config);\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.reject(error);\n\t\t}\n\t}\n);\n\nexport default $axios;\n"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,MAAM,GAAGD,KAAK,CAACE,MAAM,CAAC;EAC3BC,OAAO,EAAEC,OAAO,CAACC,GAAG,CAACC,kBAAkB;EACvCC,OAAO,EAAE,IAAI;EACbC,KAAK,EAAC,CAAC;EACPC,UAAU,EAAC;AACZ,CAAC,CAAC;;AAEF;AACAR,MAAM,CAACS,YAAY,CAACC,OAAO,CAACC,GAAG,CAC9B,UAASC,MAAM,EAAE;EAChB;EACA;EACA;EACA;EACA,MAAMC,KAAK,GAAG,QAAQ;EACtBD,MAAM,CAACE,OAAO,CAAC,SAAS,CAAC,GAAGD,KAAK;EACjC,OAAOD,MAAM;AACd,CAAC,EACD,UAASG,KAAK,EAAE;EACf;EACAC,QAAA,CAAQD,KAAK,CAACA,KAAK,CAAC;EACpB,OAAOE,OAAO,CAACC,MAAM,CAACH,KAAK,CAAC;AAC7B,CACD,CAAC;;AAED;AACAf,MAAM,CAACS,YAAY,CAACU,QAAQ,CAACR,GAAG,CAC/B,UAASQ,QAAQ,EAAE;EAClB;EACA,IAAIA,QAAQ,CAACC,IAAI,CAACC,OAAO,KAAK,KAAK,EAAE;IACpCL,QAAA,CAAQD,KAAK,CAACI,QAAQ,CAACC,IAAI,CAACE,OAAO,CAAC;EACrC;EACA,OAAOH,QAAQ;AAChB,CAAC,EACD,UAASJ,KAAK,EAAE;EACf,IAAIA,KAAK,CAACQ,IAAI,KAAK,cAAc,IAAIR,KAAK,CAACO,OAAO,CAACE,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;IAC7E,IAAIZ,MAAM,GAAGG,KAAK,CAACH,MAAM;IACzBA,MAAM,CAACa,YAAY,GAAGb,MAAM,CAACa,YAAY,IAAI,CAAC;IAE9C,IAAIb,MAAM,CAACa,YAAY,IAAIb,MAAM,CAACL,KAAK,EAAE;MACxC;MACA;MACA,OAAOU,OAAO,CAACC,MAAM,CAACH,KAAK,CAAC;IAC7B;;IAEA;IACAH,MAAM,CAACa,YAAY,IAAI,CAAC;;IAExB;IACA,IAAIC,OAAO,GAAG,IAAIT,OAAO,CAAC,UAASU,OAAO,EAAE;MAC3CC,UAAU,CAAC,YAAW;QACrB;QACAD,OAAO,CAAC,CAAC;MACV,CAAC,EAAEf,MAAM,CAACJ,UAAU,IAAI,CAAC,CAAC;IAC3B,CAAC,CAAC;IAEF,OAAOkB,OAAO,CAACG,IAAI,CAAC,YAAW;MAC9B,OAAO9B,KAAK,CAACa,MAAM,CAAC;IACrB,CAAC,CAAC;EACH,CAAC,MAAM;IACN,OAAOK,OAAO,CAACC,MAAM,CAACH,KAAK,CAAC;EAC7B;AACD,CACD,CAAC;AAAC,MAAAe,QAAA,GAEa9B,MAAM;AAArB,eAAA8B,QAAA;AAAsB;AAAA;EAAA,IAAAC,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA;EAAA,KAAAH,cAAA;IAAA;EAAA;EAAAA,cAAA,CAAAI,QAAA,CAjEhBnC,MAAM;EAAA+B,cAAA,CAAAI,QAAA,CAAAL,QAAA;AAAA;AAAA;AAAA;EAAA,IAAAM,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA;EAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module"}